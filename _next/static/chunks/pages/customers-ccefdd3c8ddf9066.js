(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2179],{12424:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/customers",function(){return l(39769)}])},34648:(e,t,l)=>{"use strict";l.d(t,{g:()=>a});let a=e=>{let t=(Math.floor(Date.now())-e)/1e3,l={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60};for(let e in l){let a=Math.floor(t/l[e]);if(a>0)return"".concat(a," ").concat(e).concat(1!==a?"s":""," ago")}return"Just now"}},39769:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>m});var a=l(37876),s=l(14232);let r=(0,l(95551).A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var n=l(43598),i=l(65259),d=l(34648),c=l(43666),o=l(54587),x=l.n(o),u=l(48230),h=l.n(u);let m=()=>{let[e,t]=(0,s.useState)([]),l=n.A.currentId(),r=(0,s.useRef)(!1),[d,c]=(0,s.useState)(0),[o,x]=(0,s.useState)(!0),u=(0,s.useRef)(null),h=(0,s.useRef)(null),m=(0,s.useRef)(!1),p=(0,s.useCallback)(async()=>{try{if(!l||m.current)return;m.current=!0;let e="limit=10&offset=".concat(10*d),{data:a,error:s}=await i.A.doGet({path:"orgs/".concat(l,"/data/threads?").concat(e)});if(s){console.error("Error fetching invited users:",s);return}if(a&&a.threads){let e=a.threads.map(e=>{var t;let l=JSON.parse(e.data);return{sender_name:l.sender_name,notification:l.notification,user:l.user,about:l.about,lead:l.lead,channel:e.channel,thread_id:e.id,last_active_at:e.last_active_at,...(null===(t=e.to)||void 0===t?void 0:t.startsWith("+"))?{contact:e.from}:{}}});r.current=!0,x(a.threads.length>0),t(t=>[...t,...e])}}catch(e){console.error("Error fetching threads:",e)}finally{m.current=!1}},[l,d]);return(0,s.useEffect)(()=>{if(u.current)return h.current&&h.current.disconnect(),h.current=new IntersectionObserver(e=>{e[0].isIntersecting&&o&&c(e=>e+1)},{threshold:.5}),u.current&&h.current.observe(u.current),()=>{h.current&&h.current.disconnect()}},[o]),(0,s.useEffect)(()=>{p(),r.current||(r.current=!0)},[d,p]),(0,a.jsxs)("div",{className:" w-full border border-slate-200 rounded bg-white p-4 md:p-7",children:[(0,a.jsx)("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center pb-4 lg:pb-6 mb-4 lg:mb-7 border-b-[0.4px] border-slate-300",children:(0,a.jsx)("div",{children:(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Active Leads"})})}),(0,a.jsxs)("div",{className:"",children:[(0,a.jsx)("div",{className:"w-full flex flex-col gap-2.5 lg:hidden",children:e.map((e,t)=>(0,a.jsx)(f,{lead:e},t))}),(0,a.jsx)(v,{leads:e}),0===e.length&&(0,a.jsx)("div",{className:"text-center py-4 mt-24 min-h-[calc(100vh-20rem)]",children:(0,a.jsx)("p",{className:"text-gray-500",children:"No leads found."})}),o&&(0,a.jsx)("div",{ref:u,className:"text-center py-4",children:"Loading..."})]})]})},f=e=>{var t,l,s,n,i,o,u;let{lead:m}=e,f={instagram:c.Rj,whatsapp:c.b_,fbpage:c.kp};return(0,a.jsxs)("div",{className:"w-full px-[15px] py-[12px] bg-[#FFFFFF] border-[#E1E7EF] border-[0.5px] shadow-md rounded flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-stretch justify-between border-b-[0.5px] border-[#E1E7EF] pb-2",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("div",{className:"flex items-start justify-start gap-1",children:[(0,a.jsx)("div",{className:"border border-neutral-300 rounded-full w-5 h-5 flex items-center justify-center",children:f[m.channel]?(0,a.jsx)(x(),{src:f[m.channel],width:10,height:10,alt:m.channel}):(0,a.jsx)("div",{className:"w-2.5 h-1.5 rounded-full"})}),(0,a.jsx)("span",{className:"text-[#1E293B] font-medium text-sm break-all",children:(null===(t=m.user)||void 0===t?void 0:t.name)||(null===(l=m.user)||void 0===l?void 0:l.phone)||(null===(s=m.user)||void 0===s?void 0:s.email)||m.sender_name})]}),(0,a.jsxs)("div",{className:"flex flex-col text-xs font-normal text-[#64748A] break-all",children:[(0,a.jsx)("span",{children:null===(n=m.user)||void 0===n?void 0:n.email}),(0,a.jsx)("span",{children:("web"===m.channel?"Not available":null===(i=m.user)||void 0===i?void 0:i.phone)||m.contact})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-1 justify-between items-end",children:[(0,a.jsx)("div",{className:"flex items-center w-9 h-9",children:(0,a.jsx)(h(),{href:{pathname:"/messages",query:{thread_id:m.thread_id}},children:(0,a.jsx)("button",{className:"textPrimary flex items-center rounded-full bgMediumBlue hover:bgHardBlue p-3 text-center cursor-pointer",children:(0,a.jsx)(r,{className:"w-4 h-4",color:"white"})})})}),(0,a.jsx)("span",{className:"flex flex-col text-xs font-normal text-[#64748A] text-end",children:(0,d.g)(Number(m.last_active_at))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs font-normal text-[#000000]",children:"Contact Objective"}),(0,a.jsx)("p",{className:"leading-[18px] text-[#64748A] text-xs font-medium",children:(null===(o=m.about)||void 0===o?void 0:o.purpose)||"Not available"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs font-normal text-[#000000]",children:"Next Steps"}),(0,a.jsx)("p",{className:"leading-[18px] text-[#64748A] text-xs font-medium",children:(null===(u=m.about)||void 0===u?void 0:u.action)||"Not available"})]})]})},v=e=>{let{leads:t}=e;return(0,a.jsxs)("div",{className:"hidden lg:flex flex-col gap-2.5",children:[t.length>0&&(0,a.jsxs)("div",{className:"grid grid-cols-6 gap-x-4 textPrimary500 text-sm font-normal px-4 py-3",children:[(0,a.jsx)("div",{className:"ml-12",children:"Name"}),(0,a.jsx)("div",{children:"Contact No."}),(0,a.jsx)("div",{children:"Last Active"}),(0,a.jsx)("div",{children:"Contact Objective"}),(0,a.jsx)("div",{children:"Next Steps"}),(0,a.jsx)("div",{children:"Message"})]}),(0,a.jsx)("div",{className:"w-full flex flex-col gap-2.5",children:t.map((e,t)=>(0,a.jsx)(p,{lead:e},t))})]})},p=e=>{var t,l,s,n,i,o,u;let{lead:m}=e,f={instagram:c.Rj,whatsapp:c.b_,fbpage:c.kp};return(0,a.jsxs)("div",{className:"grid grid-cols-6 py-5 px-4 text-gray-800 gap-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"border border-neutral-300 rounded-full p-2",children:f[m.channel]?(0,a.jsx)(x(),{src:f[m.channel],width:20,height:20,alt:m.channel}):(0,a.jsx)("div",{className:"w-5 h-5 rounded-full"})}),(0,a.jsxs)("div",{className:"flex flex-col w-full",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("p",{className:"font-normal textSecondary700 text-sm break-all",children:(null===(t=m.user)||void 0===t?void 0:t.name)||(null===(l=m.user)||void 0===l?void 0:l.phone)||(null===(s=m.user)||void 0===s?void 0:s.email)||m.sender_name})}),(0,a.jsx)("p",{className:"textPrimary500 text-sm font-normal mt-2 break-all",children:null===(n=m.user)||void 0===n?void 0:n.email})]})]}),(0,a.jsx)("div",{className:"w-full textSecondary700 text-sm font-normal break-all",children:("web"===m.channel?"Not available":null===(i=m.user)||void 0===i?void 0:i.phone)||m.contact}),(0,a.jsx)("div",{className:"textSecondary700 text-sm font-normal",children:(0,d.g)(Number(m.last_active_at))}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:(null===(o=m.about)||void 0===o?void 0:o.purpose)||"Not available"}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:(null===(u=m.about)||void 0===u?void 0:u.action)||"Not available"}),(0,a.jsx)("div",{children:(0,a.jsx)(h(),{href:{pathname:"/messages",query:{thread_id:m.thread_id}},children:(0,a.jsx)("button",{className:"textPrimary flex items-center rounded-full bgMediumBlue hover:bgHardBlue p-3 text-center cursor-pointer",children:(0,a.jsx)(r,{className:"w-4 h-4",color:"white"})})})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,6593,8792],()=>t(12424)),_N_E=e.O()}]);