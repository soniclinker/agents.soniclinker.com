(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6231],{16821:(e,t,s)=>{"use strict";s.d(t,{A:()=>u});var r=s(42874),a=s(80498),n=s(3176),i=s(65259),o=s(20318);let l=()=>n.A.apiUrl+"/connect/update";class c{static getInstance(e){return(0,r._)(c,c,d)||(0,a._)(c,c,d,new c(e)),(0,r._)(c,c,d)}setOrgId(e){this.orgId=e}on(e,t){this.listener.add(t),"not_connected"===this.status&&this.connect()}off(e){this.listener.remove(e)}setupPing(){setTimeout(()=>{this.socket&&this.socket.readyState===WebSocket.OPEN&&(this.socket.send("{}"),this.setupPing())},3e4)}connect(){if("not_connected"!==this.status)return;this.changeStatus("connecting");let e=[],t=i.A.token();t&&e.push("access_token="+t),this.orgId&&e.push("org_id="+this.orgId);let s=e.length?"?"+e.join("&"):"";this.socket=new WebSocket(l()+s),this.socket.addEventListener("open",()=>{this.changeStatus("connected"),this.setupPing()}),this.socket.addEventListener("close",()=>{this.changeStatus("not_connected"),console.log("WebSocket closed")}),this.socket.addEventListener("message",e=>{try{let t=JSON.parse(e.data);this.listener.trigger(t)}catch(t){console.error("Invalid WebSocket message:",e.data)}})}send(e){this.socket&&this.socket.readyState===WebSocket.OPEN&&this.socket.send(JSON.stringify(e))}disconnect(){if(this.socket)try{this.socket.close()}catch(e){console.error("Error closing WebSocket:",e)}}changeStatus(e){this.status!==e&&(this.status=e)}constructor(e){this.status="not_connected",this.socket=null,this.orgId=e,this.listener=new o.A}}var d={writable:!0,value:null};let u=c},32722:(e,t,s)=>{"use strict";function r(e,t){if(e!==t)throw TypeError("Private static access of wrong provenance")}s.d(t,{_:()=>r})},35712:(e,t,s)=>{"use strict";function r(e,t){if(void 0===e)throw TypeError("attempted to "+t+" private static field before its declaration")}s.d(t,{_:()=>r})},42874:(e,t,s)=>{"use strict";s.d(t,{_:()=>n});var r=s(32722),a=s(35712);function n(e,t,s){return(0,r._)(e,t),(0,a._)(s,"get"),s.get?s.get.call(e):s.value}},68391:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(37876),a=s(74562),n=s(65259),i=s(43598),o=s(14232),l=s(89099),c=s(88564),d=s(16821),u=s(91589),h=s(75683),x=s(45732),p=s(59884);let m=()=>{let[e,t]=(0,o.useState)([]),[s,m]=(0,o.useState)(""),[b,f]=(0,o.useState)("error"),[v,j]=(0,o.useState)(!1),y=(0,l.useRouter)(),N=i.A.current().id,k=async e=>{let t=await n.A.doDelete({path:"/orgs/".concat(N,"/domains/").concat(e)});if(t.error){j(!0),f("error"),m(t.error.message);return}_(),a.A.hide()},w=async(e,t)=>{let s=await n.A.doPost({path:"/orgs/".concat(N,"/domains/").concat(e,"/status"),data:{type:t}});if(s.error){j(!0),f("error"),m(s.error.message);return}a.A.hide()},_=(0,o.useCallback)(()=>setTimeout(async()=>{let e=await n.A.doGet({path:"/orgs/".concat(N,"/domains")});if(e.error){j(!0),f("error"),m(e.error.message);return}if(!e.data||!e.data.domains){console.warn("No domains found in response"),j(!0),f("error"),m("No domains found in response"),t([]);return}t(e.data.domains)},500),[N]);(0,o.useEffect)(()=>{let e=_();return()=>clearTimeout(e)},[_]),(0,o.useEffect)(()=>{let e=d.A.getInstance(N),s=e=>{"domain_status_update"===e.type?t(t=>t.map(t=>t.id===e.id?{...t,cdn_status:e.status}:t)):"dns_status_update"===e.type&&t(t=>t.map(t=>t.id===e.id?{...t,dns_status:e.status}:t))};return e.on("message",s),()=>{e.off(s)}},[N]);let C=e=>{var t;let s=(null==e?void 0:e.cdn_status)||"",r=(null==e?void 0:e.dns_status)||"";return s&&r?"deployed"===s&&(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.certificate_status)==="checking"?"Checking For DNS Record":"error"===r||"error"===s?"Error":"deployed"!==s?"Waiting for Deploymemt":"inprogress"==r||"not_connected"==r?"Waiting for DNS record":"Ready":""},S=async(e,t)=>{try{await navigator.clipboard.writeText(e),f("success"),m("".concat(t," copied to clipboard")),j(!0)}catch(e){console.error("Failed to copy text: ",e),f("error"),m("Failed to copy to clipboard"),j(!0)}};return(0,r.jsxs)("div",{className:"w-full p-[16px]",children:[0!==e.length&&(0,r.jsx)("div",{className:"w-min cursor-pointer text-4xl hover:text-gray-800 mb-4",onClick:()=>y.back(),children:(0,r.jsx)(h.eh5,{})}),(0,r.jsx)("div",{className:"m-auto absolute",children:v&&(0,r.jsx)(u.A,{type:b,message:s,onClose:()=>j(!1),autoCloseDelay:2e3})}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("div",{className:"justify-start text-black text-xl font-bold font-['Urbanist']",children:"Domain"}),(0,r.jsx)("div",{children:(0,r.jsxs)("button",{className:"flex items-center gap-[2px] w-fit px-4 py-2 bg-[#4F46E4] rounded text-white cursor-pointer",onClick:()=>a.A.show("Add Domain",(0,r.jsx)(g,{fetchDomains:_})),children:[(0,r.jsx)(x.jgn,{className:"text-[18px] font-[1000] text-white"})," Domain"]})})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("div",{children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-100 text-gray-700 font-medium py-3 px-5 sticky top-0",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"w-1/4 text-center py-2",children:"Domain"}),(0,r.jsx)("td",{className:"w-1/4 text-center py-2",children:"Status"}),(0,r.jsx)("td",{className:"w-1/4 text-center py-2",children:"Actions"})]})}),(0,r.jsxs)("tbody",{children:[e.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-white hover:cursor-pointer",children:[(0,r.jsx)("td",{className:"w-1/4 text-center py-4",title:e.domain_draft,children:(0,r.jsx)("span",{className:"text-slate-500",children:e.domain_draft})}),(0,r.jsx)("td",{className:"w-1/4 text-center py-4 capitalize",title:C(e)||"N/A",children:(0,r.jsx)("span",{className:"text-slate-500",children:C(e)||"N/A"})}),(0,r.jsx)("td",{className:"w-1/4 text-center py-4",children:(0,r.jsx)(c.GD,{className:"inline text-slate-600 hover:text-gray-400 cursor-pointer",onClick:t=>{var s,n;t.stopPropagation(),a.A.show("Settings",(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:" flex flex-col items-center gap-[8px]",children:[(0,r.jsxs)("div",{className:"bg-gray-100 p-4 rounded w-full",children:[(0,r.jsx)("div",{className:"font-semibold",children:"Please add the following CNAME records into your DNS"}),(0,r.jsxs)("table",{className:"w-full border-2 border-black table-fixed",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"border-r-2 border-black bg-white py-3 px-4 text-center font-bold text-lg",children:"Name"}),(0,r.jsx)("th",{className:"bg-white py-3 px-4 text-center font-bold text-lg",children:"Value"})]})}),(0,r.jsxs)("tbody",{children:[(null==e?void 0:e.cdn_url)&&(0,r.jsxs)("tr",{className:"border-t-2 border-black",children:[(0,r.jsx)("td",{className:"border-r-2 border-black py-4 px-4 text-center",children:(0,r.jsxs)("div",{className:"flex items-center gap-[4px] hover:bg-gray-200 px-2 py-1 rounded transition-colors break-all",children:[e.domain_draft,(0,r.jsx)("div",{className:"cursor-pointer",children:(0,r.jsx)(p.zU_,{title:"Click to copy text",onClick:()=>S("content.soniclinker.com","Domain Name")})})]})}),(0,r.jsx)("td",{className:"py-4 px-4 text-center",children:(0,r.jsxs)("div",{className:"flex items-center gap-[4px] hover:bg-gray-200 px-2 py-1 rounded transition-colors break-all",children:[e.cdn_url,(0,r.jsx)("div",{className:"cursor-pointer",children:(0,r.jsx)(p.zU_,{title:"Click to copy text",onClick:()=>S(e.cdn_url,"Deployed url")})})]})})]}),(null==e?void 0:null===(s=e.data)||void 0===s?void 0:s.name)&&(null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.value)&&(0,r.jsxs)("tr",{className:"border-t-2 border-black",children:[(0,r.jsx)("td",{className:"border-r-2 border-black py-4 px-4 text-center",children:(0,r.jsxs)("div",{className:"flex items-center gap-[4px] hover:bg-gray-200 px-2 py-1 rounded transition-colors break-all",children:[e.data.name,(0,r.jsx)("div",{className:"cursor-pointer",children:(0,r.jsx)(p.zU_,{title:"Click to copy text",onClick:()=>S(e.data.name,"Certificate Name")})})]})}),(0,r.jsx)("td",{className:"py-4 px-4 text-center",children:(0,r.jsxs)("div",{className:"flex items-center gap-[4px] hover:bg-gray-200 px-2 py-1 rounded transition-colors break-all",children:[e.data.value,(0,r.jsx)("div",{className:"cursor-pointer",children:(0,r.jsx)(p.zU_,{title:"Click to copy text",onClick:()=>S(e.data.value,"Certificate Value")})})]})})]})]})]})]}),"connected"!==e.dns_status&&"deployed"!==e.cdn_status&&(0,r.jsx)("div",{className:"w-1/2 text-center p-1 bg-blue-400 text-white rounded cursor-pointer",onClick:()=>w(e.id,"dns_status"),children:"Check Status"}),(0,r.jsx)("div",{className:"w-1/2 text-center p-1 bg-red-400 text-white rounded cursor-pointer",onClick:()=>k(e.id),children:"Delete Domain"})]})}))}})})]},e.id)),0===e.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"text-center py-4",children:(0,r.jsx)("span",{className:"text-gray-500",children:"No domains found"})})})]})]})})})]})},g=e=>{let{fetchDomains:t}=e,[s,l]=(0,o.useState)(""),[c,d]=(0,o.useState)(!1),[h,x]=(0,o.useState)(""),[p,m]=(0,o.useState)(!1),[g,b]=(0,o.useState)("error"),f=e=>{if(!e)return!1;try{let t=e.toLowerCase();if((t.startsWith("http://")||t.startsWith("https://"))&&(t=t.split("//")[1]),t=t.split("/")[0],!/^([a-zA-Z0-9]([a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/.test(t)||t.length>253||t.split(".").some(e=>e.length>63||e.startsWith("-")||e.endsWith("-")))return!1;return!0}catch(e){return!1}},v=async e=>{if(e.preventDefault(),!s)return;let r=f(s);if(!s||!r){x("Domain is not Correct"),m(!0),b("error");return}x(""),d(!0),x("Creating Domain"),m(!0),b("info");let{data:o,error:l}=await n.A.doPost({path:"/orgs/".concat(i.A.current().id,"/domains"),data:{domain_draft:s}});if(l){x(l.message),m(!0),b("error"),d(!1);return}o&&(d(!1),t(),a.A.hide())};return(0,r.jsxs)("form",{className:"flex flex-col",onSubmit:v,children:[(0,r.jsx)("div",{className:"m-auto absolute",children:p&&(0,r.jsx)(u.A,{type:g,message:h,onClose:()=>m(!1),autoCloseDelay:2e3})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"domain",className:"text-neutral-500 font-medium text-base ",children:"Domain"}),(0,r.jsx)("input",{type:"text",id:"domain",value:s,onChange:e=>l(e.target.value),placeholder:"content.soniclinker.com",className:"w-full border border-neutral-300 text-neutral-400 font-medium bg-slate-50 max-w-3xl rounded-lg p-3 mt-1 focus:ring-1 focus:ring-blue-400 focus:border-blue-400 outline-none transition"})]}),(0,r.jsx)("button",{type:"submit",disabled:!s||c,className:"px-4 py-2 mt-4 bg-blue-500 text-white rounded-md hover:bg-blue-600 cursor-pointer disabled:bg-gray-400 disabled:cursor-not-allowed transition",children:"Add"})]})}},78113:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/domains",function(){return s(68391)}])},80498:(e,t,s)=>{"use strict";s.d(t,{_:()=>n});var r=s(32722),a=s(35712);function n(e,t,s,n){return(0,r._)(e,t),(0,a._)(s,"set"),!function(e,t,s){if(t.set)t.set.call(e,s);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=s}}(e,s,n),n}},91589:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var r=s(37876),a=s(14232),n=s(75683);let i={success:"bg-green-100 text-green-800 border-green-300",info:"bg-blue-100 text-blue-800 border-blue-300",error:"bg-red-100 text-red-800 border-red-300"},o=e=>{let{type:t,message:s,className:o="",onClose:l,autoCloseDelay:c=1e3}=e;return(0,a.useEffect)(()=>{if(l){let e=setTimeout(()=>{l()},c);return()=>clearTimeout(e)}},[l,c]),(0,r.jsx)("div",{className:"fixed top-4 left-0 right-0 flex justify-center z-[9999] pointer-events-none",children:(0,r.jsxs)("div",{className:"border rounded px-4 py-3 ".concat(i[t]," ").concat(o," \n                pointer-events-auto w-fit flex justify-between items-center \n                shadow-lg animate-slide-down"),role:"alert",children:[(0,r.jsx)("span",{children:s}),l&&(0,r.jsx)("button",{onClick:l,className:"ml-4 hover:opacity-70 transition-opacity","aria-label":"Close",children:(0,r.jsx)(n.WQq,{size:20})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5711,4938,8511,636,6593,8792],()=>t(78113)),_N_E=e.O()}]);