(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8029],{41257:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>d});var a=l(37876),r=l(74562),s=l(65259),n=l(43598),o=l(89099),i=l(14232),u=l(75683);let d=()=>{let e=(0,o.useRouter)(),{prompt_id:t}=e.query,[l,n]=(0,i.useState)(null),[d,h]=(0,i.useState)(!1),[f,g]=(0,i.useState)(!1),[w,j]=(0,i.useState)(null),[v,y]=(0,i.useState)(!1),[N,C]=(0,i.useState)(null),_=async l=>{l.preventDefault();let a=Object.fromEntries(new FormData(l.currentTarget));for(let e in a){let t=a[e].toString().trim();if(!t)return;a[e]=t}g(!0);let r="_new"===t?"/ptemplates":"/ptemplates/".concat(t),o=await s.A.doPost({path:r,data:a});if(o.error){j(o.error.message),g(!1);return}g(!1),n(o.data.ptemplate),C(o.data.ptemplate),"_new"===t&&e.push({pathname:"/settings",query:{tab:"prompts"}})},S=(0,i.useCallback)(async()=>{try{h(!0);let e=await s.A.doGet({path:"/ptemplates/".concat(t)});if(e.error){j(e.error.message),h(!1);return}n(e.data.ptemplate),C(e.data.ptemplate),h(!1)}catch(e){j("Something went wrong"),h(!1)}},[t]);return((0,i.useEffect)(()=>{"_new"!==t&&S()},[t,S]),(0,i.useEffect)(()=>{JSON.stringify(l)!==JSON.stringify(N)?y(!0):y(!1)},[l,N]),w)?(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,a.jsx)("span",{className:"text-red-500",children:w})}):d?(0,a.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,a.jsx)("div",{className:"animate-spin inline-block w-8 h-8 border-[3px] border-current border-t-transparent textPrimary rounded-full"})}):(0,a.jsx)("div",{className:"w-full mx-auto bg-primary",children:(0,a.jsx)("div",{className:"w-full mx-auto relative",children:(0,a.jsxs)("div",{className:" bg-white border border-slate-200 rounded-lg px-6 py-3 mb-4 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.eh5,{className:"text-2xl font-bold cursor-pointer",onClick:()=>e.back()}),(0,a.jsx)("span",{className:"text-xl font-semibold text-gray-600",children:"_new"!==t?"Update Prompt":"Create Prompt"})]}),(0,a.jsxs)("form",{className:"ml-8",onSubmit:_,children:[(0,a.jsx)(c,{label:"Id",placeholder:"Enter prompt id",value:(null==l?void 0:l.id)||"",setValue:e=>n({...l,id:e})}),(0,a.jsx)(c,{label:"Name",placeholder:"Enter prompt name",value:(null==l?void 0:l.name)||"",setValue:e=>n({...l,name:e})}),(0,a.jsx)(m,{label:"Category",options:["Utility","Business"],value:(null==l?void 0:l.category)||"",setValue:e=>n({...l,category:e})}),(0,a.jsx)(x,{label:"Prompt",placeholder:"Enter prompt Prompt",value:(null==l?void 0:l.prompt)||"",setValue:e=>n({...l,prompt:e})}),(0,a.jsxs)("div",{className:"flex gap-4 mt-4",children:["_new"!==t&&(0,a.jsx)("button",{type:"button",className:"bgLightBlue text-white font-semibold w-40 py-2 px-4 cursor-pointer rounded-lg hover:bgMediumBlue transition disabled:bg-gray-400 disabled:cursor-not-allowed",onClick:()=>r.A.show("Test",(0,a.jsx)(b,{})),children:"Test"}),v&&(0,a.jsx)(p,{label:"_new"!==t?"Update":"Create",isLoading:f})]})]})]})})})},c=e=>{let{label:t,placeholder:l,value:r,setValue:s}=e;return(0,a.jsxs)("div",{className:"mt-4 flex flex-col",children:[(0,a.jsx)("label",{className:"text-neutral-500 font-medium text-base",htmlFor:t,children:t}),(0,a.jsx)("input",{type:"text",id:t,name:t.toLowerCase(),placeholder:l,value:r,onChange:e=>s(e.target.value),className:"border border-neutral-300 text-neutral-400 font-medium bg-primary max-w-3xl rounded-lg p-3 mt-3 focus:ring-1 focus:ring-blue-400 focus:border-blue-400 outline-none transition"})]})},m=e=>{let{label:t,options:l,value:r,setValue:s}=e;return(0,a.jsxs)("div",{className:"mt-4 flex flex-col ",children:[(0,a.jsx)("label",{className:"text-neutral-500 font-medium text-base",children:t}),(0,a.jsx)("select",{className:"border border-neutral-300 text-neutral-400 font-medium bg-primary max-w-3xl rounded-lg p-3 mt-3 focus:ring-1 focus:ring-blue-400 focus:border-blue-400 outline-none transition",name:t.toLowerCase(),id:t,value:r.toLowerCase(),onChange:e=>s(e.target.value),children:l.map(e=>(0,a.jsx)("option",{value:e.toLowerCase(),children:e},e))})]})},x=e=>{let{label:t,placeholder:l,value:r,setValue:s}=e;return(0,a.jsxs)("div",{className:"mt-4 flex flex-col",children:[(0,a.jsx)("label",{className:"text-neutral-500 font-medium text-base",htmlFor:t,children:t}),(0,a.jsx)("textarea",{id:t,name:t.toLowerCase(),placeholder:l,value:r,onChange:e=>s(e.target.value),rows:11,className:"border border-neutral-300 text-neutral-400 font-medium bg-primary w-full rounded-lg p-3 mt-3 focus:ring-1 focus:ring-blue-400 focus:border-blue-400 outline-none transition"})]})},p=e=>{let{label:t,isLoading:l}=e;return(0,a.jsx)("div",{className:"flex flex-col",children:(0,a.jsx)("button",{type:"submit",className:"bgLightBlue text-white font-semibold w-40 py-2 px-4 cursor-pointer rounded-lg hover:bgMediumBlue transition disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:l,children:l?"Plaese wait...":t})})},b=()=>{let e=["WhatsApp","Voice"],[t,l]=(0,i.useState)(e[0].toLowerCase()),[u,d]=(0,i.useState)(""),[x,b]=(0,i.useState)(!1),[h,f]=(0,i.useState)(null),[g,w]=(0,i.useState)(null),j=n.A.currentId(),{prompt_id:v}=(0,o.useRouter)().query,y=async e=>{if(e.preventDefault(),!u)return;b(!0);let l=await s.A.doGet({path:"/ptemplates/".concat(v,"/test?org_id=").concat(j,"&channel=").concat(t,"&channel_id=").concat(u)});if(l.error){f(l.error.message),b(!1);return}l.data&&w(l.data.content),b(!1)};return g?(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"mt-4 flex flex-col",children:(0,a.jsx)("textarea",{id:"testContent",name:"testContent",placeholder:"Test Content",value:g,readOnly:!0,rows:25})}),(0,a.jsx)("div",{className:"flex gap-4 mt-4 justify-end items-center",children:(0,a.jsx)("button",{type:"button",className:"bg-gray-500 text-white font-semibold w-40 py-2 px-4 cursor-pointer rounded-lg hover:bg-gray-600 transition",onClick:()=>r.A.hide(),children:"Ok"})})]}):(0,a.jsxs)("form",{onSubmit:y,children:[(0,a.jsx)(m,{label:"Channel",options:e,value:t,setValue:e=>l(e)}),(0,a.jsx)(c,{label:"Phone",placeholder:"Enter phone number",value:u,setValue:e=>d(e)}),h&&(0,a.jsx)("div",{className:"text-red-500 text-sm mt-2",children:h}),(0,a.jsxs)("div",{className:"flex gap-4 mt-4",children:[(0,a.jsx)("button",{type:"button",className:"bg-gray-500 text-white font-semibold w-40 py-2 px-4 cursor-pointer rounded-lg hover:bg-gray-600 transition",onClick:()=>r.A.hide(),children:"Cancel"}),(0,a.jsx)(p,{label:"Submit",isLoading:x})]})]})}},48269:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/prompts",function(){return l(41257)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[5711,636,6593,8792],()=>t(48269)),_N_E=e.O()}]);