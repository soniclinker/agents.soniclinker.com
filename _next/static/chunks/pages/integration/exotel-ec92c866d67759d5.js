(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4784],{7492:(e,t,r)=>{"use strict";r.d(t,{$:()=>i});var s=r(37876);r(14232);var a=r(69241),n=r(95313);let l={default:"bg-gray-500 hover:bg-gray-600 text-white",white:"bg-white hover:bg-gray-100 text-indigo-700 border border-indigo-700",primary:"bgHardBlue hover:bgHardBlue text-white",danger:"bg-red-600 hover:bg-red-700 text-white"},i=e=>{let{variant:t="default",loading:r=!1,children:i,className:d,loaderIcon:o,...c}=e;return(0,s.jsx)("button",{className:(0,a.A)(" text-xs font-semibold px-4 py-2 rounded-lg transition cursor-pointer flex items-center justify-center gap-2",l[t],d),disabled:r||c.disabled,...c,children:r?o||(0,s.jsx)(n.A,{className:"h-4 w-4 animate-spin"}):i})}},45269:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(37876),a=r(65259),n=r(43598),l=r(49034),i=r(14232),d=r(17082),o=r(75683),c=r(96154),u=r(45982),x=r(9129);r(36820);var h=r(14e3),m=r(7492);let g=function(){let[e,t]=(0,i.useState)([]),[r,l]=(0,i.useState)(!1),[d,u]=(0,i.useState)(!1),x=(0,h.useRouter)(),m=async()=>{if(!r){l(!0);try{let e=await a.A.doGet({path:"/orgs/".concat(n.A.currentId(),"/exotel/connections")});t(e.data.numbers),l(!1)}catch(e){console.log(e),t([]),l(!1)}}};return(0,i.useEffect)(()=>{m()},[d]),(0,s.jsx)("div",{className:"p-4",children:(0,s.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg p-6 text-gray-700",children:[(0,s.jsx)("button",{className:"text-4xl hover:text-gray-800 mb-4 cursor-pointer",onClick:()=>x.push("/settings/?tab=channels-management"),children:(0,s.jsx)(o.eh5,{})}),(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:"Exotel"}),(0,s.jsx)(b,{setRefetchNumbers:u})]}),r&&(0,s.jsx)("div",{className:"flex justify-center items-center h-20",children:(0,s.jsx)(c.A,{className:"animate-spin text-gray-600",size:32})}),!r&&0===e.length&&(0,s.jsx)("div",{className:"flex justify-center items-center h-20 text-gray-700 font-bold text-2xl",children:"Numbers not added yet"}),!r&&e.length>0&&(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"overflow-y-auto max-h-90 rounded-lg",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 bg-gray-100 text-gray-700 font-medium py-3 px-5 sticky top-0",children:[(0,s.jsx)("div",{children:"Number"}),(0,s.jsx)("div",{children:"Action"})]}),e.map((e,t)=>(0,s.jsx)(p,{number:e,setRefetchNumbers:u},t))]})})]})})};function b(e){let{setRefetchNumbers:t}=e,[r,d]=(0,i.useState)(!1),[o,c]=(0,i.useState)(""),[u,h]=(0,i.useState)(!1),[g,b]=(0,i.useState)(""),p=(0,i.useRef)(null),j=Intl.DateTimeFormat().resolvedOptions().timeZone,v=(0,l.Md)(j).countries[0],y=async()=>{if(!o||!o.trim()){b("Number not provided");return}h(!0);try{(await a.A.doPost({path:"/orgs/".concat(n.A.currentId(),"/exotel/connections"),data:{number:o}})).error||t(e=>!e)}catch(e){b(e.message)}d(!1),c(""),h(!1)};return(0,i.useEffect)(()=>{var e,t;r?null===(e=p.current)||void 0===e||e.showModal():null===(t=p.current)||void 0===t||t.close(),b("")},[r,o]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.$,{variant:"primary",onClick:()=>d(!0),children:"Add New"}),(0,s.jsxs)("dialog",{ref:p,className:"bg-white p-6 rounded-lg shadow-lg text-gray-700 fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",onClick:e=>{e.target===p.current&&d(!1)},children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Enter Exotel Number"}),(0,s.jsx)(x.Ay,{international:!0,defaultCountry:v,value:o,onChange:c,inputComponent:f}),g&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-2 text-right",children:g}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,s.jsx)(m.$,{variant:"default",onClick:()=>d(!1),className:"px-4 py-2 bg-gray-300 rounded-md hover:bg-gray-400",children:"Cancel"}),(0,s.jsx)(m.$,{variant:"primary",onClick:y,disabled:u,children:"Add"})]})]})]})}let f=(0,i.forwardRef)((e,t)=>{let{value:r,onChange:a}=e;return(0,s.jsx)("input",{ref:t,type:"tel",value:r,onChange:a,className:"w-full p-2 border border-gray-400 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),p=e=>{let{number:t,setRefetchNumbers:r}=e,l=async()=>{try{(await a.A.doDelete({path:"/orgs/".concat(n.A.currentId(),"/exotel/connections/").concat(t)})).error||r(e=>!e)}catch(e){console.log(e)}};return(0,s.jsxs)("div",{className:"grid grid-cols-2 items-center py-4 px-5 border-b border-gray-100 hover:bg-gray-50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(d.d$e,{className:"w-10 h-10 rounded-full",color:"gray"}),(0,s.jsx)("div",{className:"max-w-[160px] overflow-hidden text-ellipsis whitespace-nowrap",title:t||"N/A",children:(0,s.jsx)("span",{className:"inline-block",children:t})})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{className:"text-red-600 hover:text-red-800",onClick:()=>l(),children:(0,s.jsx)(u.A,{size:20,className:"cursor-pointer"})})})]})}},96322:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/integration/exotel",function(){return r(45269)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[5711,8585,4e3,9034,950,636,6593,8792],()=>t(96322)),_N_E=e.O()}]);