(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7138],{10377:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/aeo/citations",function(){return s(73795)}])},20477:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var l=s(37876),a=s(68951),r=s.n(a),i=s(46104);s(14232);let n=e=>{let{isOpen:t,onClose:s,title:a,children:n}=e;return t?(0,l.jsxs)("div",{className:"jsx-593ab1484ff139da fixed inset-0 z-50 flex",children:[(0,l.jsx)("div",{onClick:s,className:"jsx-593ab1484ff139da fixed inset-0 bg-black/20 transition-opacity"}),(0,l.jsxs)("div",{className:"jsx-593ab1484ff139da ml-auto w-full md:w-1/2 h-full bg-white shadow-xl p-6 relative animate-slide-in-right overflow-y-auto",children:[(0,l.jsx)("button",{onClick:s,"aria-label":"Close",className:"jsx-593ab1484ff139da absolute top-4 right-4 text-2xl text-gray-400 hover:text-gray-700",children:(0,l.jsx)(i.A,{className:"cursor-pointer",size:20})}),n]}),(0,l.jsx)(r(),{id:"593ab1484ff139da",children:"@-webkit-keyframes slide-in-right{from{-webkit-transform:translatex(100%);transform:translatex(100%)}to{-webkit-transform:translatex(0);transform:translatex(0)}}@-moz-keyframes slide-in-right{from{-moz-transform:translatex(100%);transform:translatex(100%)}to{-moz-transform:translatex(0);transform:translatex(0)}}@-o-keyframes slide-in-right{from{-o-transform:translatex(100%);transform:translatex(100%)}to{-o-transform:translatex(0);transform:translatex(0)}}@keyframes slide-in-right{from{-webkit-transform:translatex(100%);-moz-transform:translatex(100%);-o-transform:translatex(100%);transform:translatex(100%)}to{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0)}}.animate-slide-in-right{-webkit-animation:slide-in-right.3s cubic-bezier(.4,0,.2,1);-moz-animation:slide-in-right.3s cubic-bezier(.4,0,.2,1);-o-animation:slide-in-right.3s cubic-bezier(.4,0,.2,1);animation:slide-in-right.3s cubic-bezier(.4,0,.2,1)}"})]}):null}},73795:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var l=s(37876),a=s(14232),r=s(89099),i=s(65259),n=s(43598),o=s(20477);let d=e=>{let{domain:t,data:s,urlToQueryCount:a}=e;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"text-indigo-600 text-base font-bold mb-9",children:["Domain: ",t]}),(0,l.jsxs)("div",{className:"hidden md:grid grid-cols-12 gap-0 bg-neutral-100/50 border-b-[0.80px] border-neutral-200 text-neutral-500 text-xs font-semibold ",children:[(0,l.jsx)("div",{className:"px-2 py-2 col-span-10",children:"Webpage URL"}),(0,l.jsx)("div",{className:"px-2 py-2 col-span-2",children:"Questions"})]}),s.map((e,t)=>{var s;return(0,l.jsxs)("div",{className:"hidden md:grid grid-cols-12 gap-0 border-b-[0.80px] border-neutral-200 text-xs items-center",children:[(0,l.jsx)("div",{className:"px-2 py-2 text-blue-700 underline cursor-pointer break-all col-span-10",children:(0,l.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:e.url})}),(0,l.jsx)("div",{className:"px-2 py-2 col-span-2",children:a?null!==(s=a[e.url])&&void 0!==s?s:"-":0})]},e.url+t)}),(0,l.jsx)("div",{className:"block md:hidden",children:s.map((e,t)=>{var s,r;return(0,l.jsx)("div",{className:" rounded shadow-[0px_1px_2px_-1px_rgba(0,0,0,0.10)] outline-[0.50px] outline-offset-[-0.50px] outline-slate-200 p-4 mb-3 bg-white",children:(0,l.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,l.jsx)("div",{className:"flex flex-col justify-between min-w-0",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm text-gray-500",children:"Web Url:"}),(0,l.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 font-semibold break-all",children:e.url})]})}),(0,l.jsx)("div",{className:"flex flex-col items-end justify-between text-sm text-gray-500 flex-shrink-0",children:(0,l.jsxs)("div",{className:"text-right",children:["Questions:"," ",(0,l.jsx)("span",{className:"font-bold text-black text-lg",children:a?null!==(s=a[e.url])&&void 0!==s?s:"-":null!==(r=e.cited)&&void 0!==r?r:"-"})]})})]})},e.url+t+"-card")})})]})};var u=s(42059),c=s(74562),x=s(6630),m=s(98188),f=s(14084),h=s(21358);let b=()=>{var e,t,s,b,v,p,g,j,k,y,w,N;let _=(0,r.useRouter)().query.runId,[A,z]=(0,a.useState)([]),[C,S]=(0,a.useState)(null),[E,q]=(0,a.useState)(null),[P,D]=(0,a.useState)(!1),[R,L]=(0,a.useState)(!1),[M,Q]=(0,a.useState)(null),[T,F]=(0,a.useState)(null),[G,I]=(0,a.useState)(!1),O=((null==E?void 0:null===(t=E.result)||void 0===t?void 0:null===(e=t.all)||void 0===e?void 0:e.domains)||[]).map(e=>({domain:e.name,frequency:e.num_urls,source:e.type||"-",viewMore:"#"})),[U,V]=(0,a.useState)(1),[W,X]=(0,a.useState)(10),K=Math.ceil(O.length/W),B=O.slice((U-1)*W,U*W);(0,a.useEffect)(()=>{U>K&&V(1)},[O,K,U]),(0,a.useEffect)(()=>{(async()=>{D(!0),Q(null);let e=await n.A.checkAndGetAeoProject();if(!e)return Q("Project not found"),D(!1),c.A.show("Create new project",(0,l.jsx)(x.default,{}),!1,"90%");let{data:t,error:s}=await i.A.doGet({path:"/orgs/".concat(n.A.current().id,"/aeoanalysis/tasks?queryset_id=").concat(e.id)});if(s){Q("Failed to fetch runs"),D(!1);return}if(z(t.tasks||[]),_&&t.tasks){let e=t.tasks.find(e=>e.id===_);e?S(e):t.tasks.length>0&&S(t.tasks[0])}else t.tasks&&t.tasks.length>0&&S(t.tasks[0]);D(!1)})()},[_]),(0,a.useEffect)(()=>{let e=async()=>{if(!C)return;L(!0),Q(null);let{data:e,error:t}=await i.A.doGet({path:"/orgs/".concat(n.A.current().id,"/aeoanalysis/tasks/").concat(C.id,"?fetch_result=true")});if(t){Q("Failed to fetch analysis data"),L(!1);return}q(e.task),L(!1)};C&&e()},[C]);let H=C?new Date(Number(C.created_at)).toLocaleString():"-",J=null!==(y=null==E?void 0:null===(v=E.result)||void 0===v?void 0:null===(b=v.all)||void 0===b?void 0:null===(s=b.queries)||void 0===s?void 0:s.length)&&void 0!==y?y:"-",Y=[];T&&E&&(Y=((null===(N=E.result)||void 0===N?void 0:null===(w=N.all)||void 0===w?void 0:w.urls)||[]).filter(e=>e.link&&e.link.includes(T||"")).map(e=>({url:e.link,topic:e.type||"-",cited:e.cited,questions:e.questions,sov:e.sov})));let Z={};(null==E?void 0:null===(g=E.result)||void 0===g?void 0:null===(p=g.all)||void 0===p?void 0:p.queries)&&E.result.all.queries.forEach(e=>{e.urls.forEach(e=>{e.includes(T||"")&&(Z[e]=(Z[e]||0)+1)})});let $=0;return T&&(null==E?void 0:null===(k=E.result)||void 0===k?void 0:null===(j=k.all)||void 0===j?void 0:j.queries)&&E.result.all.queries.forEach(e=>{e.urls.forEach(e=>{e.includes(T)&&$++})}),(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex flex-col bg-white",children:[(0,l.jsx)("div",{className:"sticky top-0 z-30 bg-white",children:(0,l.jsx)(u.A,{})}),A.length>0&&(0,l.jsx)("div",{className:"px-6 py-4 sticky top-[57px] z-20 bg-violet-50 flex flex-col md:flex-row md:items-center md:justify-between mb-2 md:mb-0",children:(0,l.jsx)(h.A,{runs:A,selectedRun:C,onSelectRun:e=>{S(e)},runDate:H,numQuestions:J})}),(0,l.jsx)(f.A,{headers:[{key:"domain",label:"Top Domain"},{key:"frequency",label:"URL Count"},{key:"source",label:"Source"},{key:"view",label:"View More"}],data:B,isLoading:P||R,rowKey:e=>e.domain,className:{table:"h-[calc(100vh-12.1875rem)]",header:"border-b border-neutral-200 text-neutral-500 text-xs font-medium bg-neutral-100!",body:"border-b border-neutral-200",bodyData:"text-sm"},renderCell:(e,t)=>"view"===t.key?(0,l.jsx)("button",{className:"text-indigo-600 hover:underline text-xs font-medium",onClick:()=>{F(e.domain),I(!0)},children:"View More"}):t.key in e?e[t.key]:void 0,children:(0,l.jsx)(m.A,{currentPage:U,setCurrentPage:V,totalItems:O.length,itemsPerPage:W,setItemsPerPage:X})}),(0,l.jsx)(o.A,{isOpen:G,onClose:()=>I(!1),title:T?"Domain: ".concat(T):"",children:(0,l.jsx)("div",{className:"w-full",children:(0,l.jsx)("div",{className:"md:min-w-[600px] w-full text-xs",children:(0,l.jsx)(d,{domain:T||"",data:Y,urlToQueryCount:Z,domainCitedCount:$})})})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[7141,9034,9526,4249,9946,636,6593,8792],()=>t(10377)),_N_E=e.O()}]);