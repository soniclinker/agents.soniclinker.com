(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8297],{6246:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(95551).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},28067:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(95551).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},48963:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(95551).A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},49279:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var l=s(37876),n=s(14232),a=s(9614),r=s(89099),i=s(65259),o=s(43598),u=s(42059),d=s(74562),c=s(6630),v=s(98188),h=s(14084),f=s(21358);let m=()=>{var e,t,s,a,m,x,k,g,y,w,p;let j=(0,r.useRouter)().query.runId,[A,_]=(0,n.useState)([]),[N,S]=(0,n.useState)(null),[P,E]=(0,n.useState)(null),[q,C]=(0,n.useState)(!1),[F,I]=(0,n.useState)(!1),[z,D]=(0,n.useState)(null),[G,M]=(0,n.useState)(1),[R,B]=(0,n.useState)(10),L="My Brand";if(null==P?void 0:null===(t=P.result)||void 0===t?void 0:null===(e=t.info)||void 0===e?void 0:e.args){for(let e of P.result.info.args)if("brand"===e.id){L=(e.value||"").trim().split(",")[0].trim();break}}let O=[{name:L,sov:(null==P?void 0:null===(a=P.result)||void 0===a?void 0:null===(s=a.own)||void 0===s?void 0:s.sov)||0,queries:(null==P?void 0:null===(x=P.result)||void 0===x?void 0:null===(m=x.own)||void 0===m?void 0:m.queries)||[]},...(null==P?void 0:null===(k=P.result)||void 0===k?void 0:k.others)||[]];O.sort((e,t)=>t.sov-e.sov);let T=Math.ceil(O.length/R),X=O.slice((G-1)*R,G*R);(0,n.useEffect)(()=>{G>T&&T>0?M(T):0===T&&1!==G&&M(1)},[O.length,T,G]),(0,n.useEffect)(()=>{(async()=>{C(!0),D(null);let e=await o.A.checkAndGetAeoProject();if(!e)return D("Project not found"),C(!1),d.A.show("Create new project",(0,l.jsx)(c.default,{}),!1,"90%");let{data:t,error:s}=await i.A.doGet({path:"/orgs/".concat(o.A.current().id,"/aeoanalysis/tasks?queryset_id=").concat(e.id)});if(s){D("Failed to fetch runs"),C(!1);return}if(_(t.tasks||[]),j&&t.tasks){let e=t.tasks.find(e=>e.id===j);e?S(e):t.tasks.length>0&&S(t.tasks[0])}else t.tasks&&t.tasks.length>0&&S(t.tasks[0]);C(!1)})()},[j]),(0,n.useEffect)(()=>{let e=async()=>{if(!N)return;I(!0),D(null);let{data:e,error:t}=await i.A.doGet({path:"/orgs/".concat(o.A.current().id,"/aeoanalysis/tasks/").concat(N.id,"?fetch_result=true")});if(t){D("Failed to fetch analysis data"),C(!1);return}E(e.task),I(!1)};N&&e()},[N]);let H=N?new Date(Number(N.created_at)).toLocaleString():"-",K=null!==(p=null==P?void 0:null===(w=P.result)||void 0===w?void 0:null===(y=w.all)||void 0===y?void 0:null===(g=y.queries)||void 0===g?void 0:g.length)&&void 0!==p?p:"-";return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex flex-col bg-white",children:[(0,l.jsx)("div",{className:"sticky top-0 z-30 bg-white",children:(0,l.jsx)(u.A,{})}),A.length>0&&(0,l.jsx)("div",{className:"sticky top-[57px] z-20 bg-violet-50 flex flex-col md:flex-row md:items-center md:justify-between mb-2 md:mb-0 px-6 py-4",children:(0,l.jsx)(f.A,{runs:A,selectedRun:N,onSelectRun:e=>{S(e)},runDate:H,numQuestions:K})}),(0,l.jsx)(h.A,{headers:[{label:(0,l.jsx)(b,{label:"Brand"}),key:"brand"},{label:(0,l.jsx)(b,{label:"Mentions"}),key:"mentions"},{label:(0,l.jsx)(b,{label:"Share of Voice"}),key:"sov"}],data:X,isLoading:q||F,rowKey:e=>e.name,renderCell:(e,t)=>{if("brand"===t.key)return e.name===L?(0,l.jsx)("span",{className:"text-[#4F46E5] font-bold",children:e.name}):e.name;if("mentions"===t.key)return e.queries.length;if("sov"===t.key){let t=e.sov;return"number"==typeof t?Number.isInteger(t)?"".concat(t," %"):"".concat(t.toFixed(2)," %"):"--"}return t.key in e?e[t.key]:void 0},className:{table:"h-[calc(100vh-12.1875rem)]",header:"border-b border-neutral-200 text-neutral-500 text-xs font-medium bg-neutral-100!",body:"border-b border-neutral-200",bodyData:"text-sm"},children:(0,l.jsx)(v.A,{currentPage:G,setCurrentPage:M,totalItems:O.length,itemsPerPage:R,setItemsPerPage:B})})]})})},b=e=>{let{label:t}=e;return(0,l.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,l.jsx)("span",{children:t}),(0,l.jsx)(a.H2l,{size:16,className:"text-neutral-500"})]})}},75889:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/aeo/competitive-insights",function(){return s(49279)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[7141,9034,4249,9946,636,6593,8792],()=>t(75889)),_N_E=e.O()}]);