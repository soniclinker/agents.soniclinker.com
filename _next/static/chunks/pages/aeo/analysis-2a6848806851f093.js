(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2142],{12476:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var r=s(37876);s(14232);let l=e=>{let{fields:t,renderRow:s}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"grid grid-cols-".concat(t.length," place-items-center gap-1 sm:gap-2 md:gap-3 lg:gap-4 bg-gray-100 text-gray-700 font-medium py-3 px-10 sticky top-0 z-20\n          bg-primary/50 rounded-tl rounded-tr border-l border-r border-b border-slate-200 border-t"),children:t.map((e,t)=>(0,r.jsx)("div",{className:"text-sm lg:text-base w-full h-full text-start",children:e},t))}),(0,r.jsx)("div",{children:s()})]})}},15080:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var r=s(37876),l=s(74562),n=s(89099),a=s(14232),i=s(65259),o=s(43598),c=s(12476),d=s(24480),u=s(49459),p=s(32675),x=s(75683);let g=()=>{let[e,t]=(0,a.useState)([]),[s,g]=(0,a.useState)(!1),[m,b]=(0,a.useState)(null),[f,j]=(0,a.useState)(!1),[y,v]=(0,a.useState)(!1),N=(0,n.useRouter)(),w=N.query.id,k=(0,a.useCallback)(async()=>{0===e.length&&g(!0);let s="/orgs/".concat(o.A.current().id,"/aeoanalysis/tasks");w&&(s+="?queryset_id=".concat(w));let{data:r,error:l}=await i.A.doGet({path:s});if(l){console.log("Error fetching tasks"),b(l.message),g(!1);return}if(r){if(0===r.tasks.length){b("No report found"),t([]),g(!1);return}b(null),t(r.tasks),g(!1)}},[e.length,w]);return(0,a.useEffect)(()=>{k()},[f,k]),(0,r.jsxs)("div",{className:"bg-white p-2 lg:p-6 min-h-[calc(100vh-80px)]",children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-5 sticky top-0",children:(0,r.jsxs)("div",{className:"flex gap-4 items-center justify-center",children:[(0,r.jsx)("button",{className:"text-4xl hover:text-gray-800 cursor-pointer",onClick:()=>N.back(),children:(0,r.jsx)(x.eh5,{})}),(0,r.jsx)("h2",{className:"text-lg lg:text-2xl font-semibold text-[#1E2035]",children:"Reports"})]})}),s&&(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-gray-900"})}),!s&&m&&(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-red-500",children:m})}),!s&&e.length>0&&(0,r.jsx)(c.A,{fields:["Time","Question Set","Status","Actions"],renderRow:()=>e.map(e=>{var t;return(0,r.jsxs)(d.A,{columns:4,onClick:()=>{N.push("/aeo/analysis/details?id=".concat(e.id))},children:[(0,r.jsx)("div",{className:"text-blue-500 w-full h-full text-center",title:e.created_at.toString(),children:(0,r.jsx)("span",{className:"inline-block text-blue-500",children:new Date(Number(e.created_at)).toLocaleString()})}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{className:"text-sm lg:text-base w-full h-full text-center",children:null===(t=e.data)||void 0===t?void 0:t.queryset_name})}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{className:"".concat("running"===e.status?"text-blue-500 bg-blue-100":"completed"===e.status?"text-green-500 bg-green-100":"text-red-500 bg-red-100"," rounded-[20px] px-2 py-1 text-sm font-normal capitalize"),children:e.status||"N/A"})}),(0,r.jsxs)(u.A,{children:[(0,r.jsx)(p.A,{label:"View details",action:t=>{t.stopPropagation(),N.push("/aeo/analysis/details?id=".concat(e.id))}}),(0,r.jsx)(p.A,{label:"Delete",action:t=>{t.stopPropagation(),l.A.show("Delete Report",(0,r.jsx)(h,{id:e.id,setRefetchTask:j}))}})]})]},e.id)})})]})},h=e=>{let{id:t,setRefetchTask:s}=e,[n,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(null),p=async()=>{u(null),c(!0);let e=await i.A.doDelete({path:"/orgs/".concat(o.A.current().id,"/aeoanalysis/tasks/").concat(t)});if(e.error){u(e.error.message),c(!1);return}c(!1),l.A.hide(),s(e=>!e)};return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex items-center justify-start",children:(0,r.jsx)("span",{children:"Are you sure you want to delete this report?"})}),d&&(0,r.jsx)("div",{className:"flex items-center justify-end",children:(0,r.jsx)("span",{className:"text-red-500",children:d})}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,r.jsx)("button",{type:"button",className:"lg:px-4 lg:py-2 text-sm px-2 py-1 bg-gray-500 text-white rounded cursor-pointer",onClick:()=>l.A.hide(),children:"Cancel"}),(0,r.jsx)("button",{type:"button",className:"lg:px-4 lg:py-2 text-sm px-2 py-1 bg-red-600 text-white rounded cursor-pointer disabled:bg-gray-400 disabled:cursor-not-allowed",onClick:p,disabled:n,children:"Delete"})]})]})}},24480:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var r=s(37876);let l=e=>{let{children:t,columns:s,...l}=e;return(0,r.jsx)("div",{className:"grid grid-cols-".concat(s," gap-2 sm:gap-3 md:gap-3 lg-gap-5 place-items-start py-4 px-5 border-b border-l border-r border-gray-100 hover:bg-gray-50"),...l,children:t})}},32675:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var r=s(37876);s(14232);let l=e=>{let{label:t,action:s}=e;return(0,r.jsx)("button",{className:"py-1 px-2 hover:bg-gray-100 rounded cursor-pointer block w-full text-left",onClick:s,children:t})}},38567:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/aeo/analysis",function(){return s(15080)}])},49459:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(37876),l=s(14232),n=s(26478);let a=e=>{let{children:t}=e,[s,a]=(0,l.useState)(!1),i=(0,l.useRef)(null),o=(0,l.useRef)(null);(0,l.useEffect)(()=>{if(!s)return;let e=i.current,t=o.current;e&&t&&requestAnimationFrame(()=>{let s=e.getBoundingClientRect(),r=t.getBoundingClientRect(),l={top:s.top,bottom:window.innerHeight-s.bottom,left:s.left,right:window.innerWidth-s.right};Object.assign(t.style,{top:"",bottom:"",left:"",right:""}),l.right>=r.width?(t.style.left="120%",t.style.top="0"):l.left>=r.width&&(t.style.right="120%",t.style.top="0"),l.bottom<=r.height&&(t.style.top="-".concat(r.height-s.height,"px"))})},[s]);let c=l.Children.map(t,e=>l.isValidElement(e)?l.cloneElement(e,{onClick:t=>{"onClick"in e.props&&"function"==typeof e.props.onClick&&e.props.onClick(t),a(!1)}}):e);return(0,l.useEffect)(()=>{let e=e=>{var t,s;(null===(t=i.current)||void 0===t?void 0:t.contains(e.target))||(null===(s=o.current)||void 0===s?void 0:s.contains(e.target))||a(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.jsx)("div",{className:"relative",children:(0,r.jsxs)("div",{className:"inline-block z-10",children:[(0,r.jsx)("button",{ref:i,onClick:e=>{e.stopPropagation(),a(e=>!e)},className:"p-2 rounded bg-gray-100 cursor-pointer",children:(0,r.jsx)(n.Ym0,{})}),s&&(0,r.jsx)("div",{ref:o,className:"absolute min-w-[150px] p-1 bg-white shadow-[0_0_5px_rgba(0,0,0,0.2)] rounded-lg z-50 transition-all",children:c})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5711,2517,636,6593,8792],()=>t(38567)),_N_E=e.O()}]);