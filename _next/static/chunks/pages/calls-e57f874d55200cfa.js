(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3947],{11108:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/calls",function(){return a(63570)}])},11234:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});var s=a(37876),l=a(97355);let n=e=>{let{children:t,className:a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("bg-white shadow-sm rounded-lg border-[0.4px] border-slate-200",a),children:t})}},34648:(e,t,a)=>{"use strict";a.d(t,{g:()=>s});let s=e=>{let t=(Math.floor(Date.now())-e)/1e3,a={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60};for(let e in a){let s=Math.floor(t/a[e]);if(s>0)return"".concat(s," ").concat(e).concat(1!==s?"s":""," ago")}return"Just now"}},63570:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var s=a(37876),l=a(14232),n=a(11234),r=a(25581),c=a(32384),d=a(65259),o=a(43598),i=a(34648);function m(e){let t=e.getHours(),a=e.getMinutes();return"".concat(x(t%12||12),":").concat(x(a)," ").concat(t<12?"AM":"PM")}function x(e){return(e<10?"0":"")+e}let u=()=>{var e,t,a,x,u,h,p;let[f,v]=(0,l.useState)(null),[N,j]=(0,l.useState)(null),[y,b]=(0,l.useState)("All"),[g,w]=(0,l.useState)([]),[S,_]=(0,l.useState)(!1),[C,k]=(0,l.useState)(null),A=o.A.current().id,D=e=>e?e.startsWith("+")?e:"user-"+e:"",P=(0,l.useCallback)(async()=>{_(!0),k(null);let{data:e,error:t}=await d.A.doGet({path:"orgs/".concat(A,"/data/calls")});if(t){console.log(t),k("Something went wrong"),_(!1);return}let a=null==e?void 0:e.conversations;if(!a||!a.length){k("Call logs not found"),_(!1);return}for(let e of a)e.data=JSON.parse(e.data),e.thread.data=JSON.parse(e.thread.data);w(a),_(!1)},[A]),E=(0,l.useCallback)(async e=>{if(!e)return;let{data:t,error:a}=await d.A.doGet({path:"orgs/".concat(A,"/data/calls/").concat(e)});if(a){console.log(a);return}if(t){let e=t.messages;e&&e.length&&j(e.map(e=>JSON.parse(e.data).message))}},[A]);return(0,l.useEffect)(()=>{f&&E(f.id)},[f,E]),(0,l.useEffect)(()=>{P()},[P]),(0,s.jsxs)("div",{className:"flex gap-6 p-4",children:[(0,s.jsxs)("div",{className:"flex-1 space-y-4 max-h-[88vh] overflow-hidden ".concat(f?"hidden":""," md:block"),children:[(0,s.jsx)("div",{className:"flex flex-col relative",children:(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsx)("h2",{className:"text-sm font-semibold",children:"Recent Calls"})})}),(0,s.jsxs)("div",{className:"max-h-[calc(100vh-200px)] md:max-h-[calc(100vh-150px)] pb-1 overflow-auto scrollbar-hidden space-y-4",children:[C&&(0,s.jsx)("p",{className:"text-center",children:C}),S&&(0,s.jsx)("div",{className:"w-full h-full flex justify-center items-center mt-6",children:(0,s.jsx)("div",{className:"animate-spin inline-block w-8 h-8 border-[3px] border-current border-t-transparent textPrimary rounded-full"})}),g.map(e=>{var t,a,l,d,o,m;return(0,s.jsxs)(n.Z,{className:"py-5 px-6 flex justify-between",children:[(0,s.jsx)("div",{className:"flex gap-4",children:(0,s.jsxs)("div",{className:" flex flex-col items-start",children:[(0,s.jsxs)("div",{className:"flex items-center justify-start gap-2 flex-wrap",children:[(0,s.jsx)("p",{className:"font-semibold text-xs textSecondary700",children:(null===(a=e.data)||void 0===a?void 0:null===(t=a.metadata)||void 0===t?void 0:t.user_name)||D(null===(o=e.thread)||void 0===o?void 0:null===(d=o.data)||void 0===d?void 0:null===(l=d.user)||void 0===l?void 0:l.phone)||"N/A"}),(0,s.jsxs)("p",{className:"text-xs font-normal textPrimary500 flex items-center justify-center",children:[(0,s.jsx)(r.dnm,{}),(0,i.g)(e.start_time)]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("h3",{className:"text-xs font-semibold textSecondary700",children:"Call Summary"}),(0,s.jsx)("p",{className:"text-xs font-md leading-4 textPrimary500 mt-3 max-w-4xl",children:null===(m=e.data.metadata)||void 0===m?void 0:m.summary})]})]})}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("button",{className:"px-2 py-1 bg-primary border-[0.3px] border-slate-200 shadow-sm rounded hover:bg-gray-100",onClick:()=>v(e),children:(0,s.jsx)(c.ByU,{size:18})})})]},e.id)})]})]}),f&&(0,s.jsxs)(n.Z,{className:"w-full md:w-1/3 relative h-[calc(100vh-160px)] md:h-[calc(100vh-115px)] overflow-auto",children:[(0,s.jsx)("div",{className:"px-4 py-2 sticky top-0 bg-white",children:(0,s.jsx)("button",{className:"rounded-md cursor-pointer",onClick:()=>v(null),children:"X"})}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"text-center border-b-[0.5px] border-slate-300 pb-6",children:[(0,s.jsx)("h3",{className:"font-bold text-base textSecondary700 ",children:(null===(e=f.data.metadata)||void 0===e?void 0:e.user_name)||f.thread.data.sender_name||"anonymous"}),(0,s.jsx)("p",{className:"text-sm text-normal mt-2 textPrimary500",children:(null===(x=f.thread)||void 0===x?void 0:null===(a=x.data)||void 0===a?void 0:null===(t=a.user)||void 0===t?void 0:t.phone)||"N/A"}),(0,s.jsxs)("p",{className:"text-xs font-bold textSecondary600 mt-3",children:["Completed Calls",(0,s.jsx)("span",{className:"ml-2 font-medium text-neutral-500 text-xs",children:function(e){let t=new Date(e),a=new Date,s=new Date(a.getTime()-864e5);return t.toDateString()===a.toDateString()?"Today, ".concat(m(t)):t.toDateString()===s.toDateString()?"Yesterday, ".concat(m(t)):"".concat(function(e){let t=e.getFullYear(),a=e.toLocaleString("default",{month:"short"}),s=e.getDate();return t===new Date().getFullYear()?"".concat(a," ").concat(s):"".concat(t," ").concat(a," ").concat(s)}(t),", ").concat(m(t))}(Number(f.start_time))})]})]}),(0,s.jsxs)("div",{className:"mt-6 p-2",children:[(0,s.jsx)("h3",{className:"font-bold text-sm textSecondary700",children:"Call Purpose"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-3",children:(null===(u=f.data.metadata)||void 0===u?void 0:u.purpose)||"N/A"}),(0,s.jsx)("h3",{className:"font-bold text-sm textSecondary700 mt-4",children:"Call Summary"}),(0,s.jsx)("p",{className:"text-sm textSecondary600 mt-3",children:(null===(h=f.data.metadata)||void 0===h?void 0:h.summary)||"N/A"}),(0,s.jsx)("h3",{className:"font-bold text-sm textSecondary700 mt-4",children:"Next step"}),(0,s.jsx)("p",{className:"text-sm textSecondary600 mt-3",children:(null===(p=f.data.metadata)||void 0===p?void 0:p.action)||"N/A"}),(0,s.jsx)("h3",{className:"font-bold text-sm textSecondary700 mt-4",children:"Transcript"}),(0,s.jsx)("div",{children:N?N.map((e,t)=>{let{role:a,content:l}=e;return(0,s.jsxs)("div",{className:"text-sm textSecondary600 mt-8",children:[(0,s.jsx)("span",{className:"font-bold bg-gray-200 py-[2px] px-2 rounded",children:"assistant"===a?"AI":"You"}),(0,s.jsx)("p",{className:"mt-1",children:l})]},t)}):(0,s.jsx)("p",{className:"text-sm textSecondary600 mt-3",children:"Transcript not available"})})]})]})]})]})}},97355:(e,t,a)=>{"use strict";function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")}a.d(t,{cn:()=>s})}},e=>{var t=t=>e(e.s=t);e.O(0,[5015,636,6593,8792],()=>t(11108)),_N_E=e.O()}]);